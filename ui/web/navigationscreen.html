<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="/static/css/navigationscreen.css">
    <title>TradeWars</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body onkeypress="decodeKeyPress(event)">

    <div class="header">TradeWars!</div>
    <button onclick="window.location.href = '/chat'">Chat Screen</button>
    <div class="status">Status Messages
        <div id="callsign">{{.Callsign}}</div>
    </div>
    <table id="grid">
        <caption class="grid-caption">Space Grid</caption>
        <tr>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
        </tr>
        <tr>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
        </tr>
        <tr>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
        </tr>
        <tr>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
        </tr>
        <tr>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
        </tr>
        <tr>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
        </tr>
        <tr>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
        </tr>
        <tr>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
        </tr>
        <tr>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
        </tr>
        <tr>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
            <td class="grid-td"></td>
        </tr>
    </table>
 
    <table class="cargo">
        <caption class="cargo-caption">Cargo</caption>
        <tr>
            <td class="cargo-td-item">Spacesuit</td>
            <td class="cargo-td-amount">2 units</td>
        </tr>
        <tr>
            <td class="cargo-td-item"></td>
            <td class="cargo-td-amount"></td>
        </tr>
        <tr>
            <td class="cargo-td-item"></td>
            <td class="cargo-td-amount"></td>
        </tr>
    </table>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<!--     <script>
        $(document).ready(function(){
            $(document.getElementById("grid").rows[3].cells[3]).html("<img class='spaceship' src=/static/images/spaceship.png>");
        })
    </script>
 -->
    <script>
        currentCoords = [3, 3]

        function placeShip(){
            $(document.getElementById("grid").rows[3].cells[3]).html("<img class='spaceship' src=/static/images/spaceship.png>");
        }

        function decodeKeyPress(event){
            var keyCode = event.which || event.keyCode;
            if (keyCode == 119) {
                moveShip([currentCoords[0]-1, currentCoords[1]])
            } else if (keyCode == 115) {
                moveShip([currentCoords[0]+1, currentCoords[1]])
            } else if (keyCode == 100) {
                moveShip([currentCoords[0], currentCoords[1]+1])
            } else if (keyCode == 97) {
                moveShip([currentCoords[0], currentCoords[1]-1])
            }
        }

        // function updateServer(coords){
        //     const http = new XMLHttpRequest();
        //     const url ='http://trade-wars-client.herokuapp.com/map';
        //     const updatedCoords = coords
        //     Http.open("POST", url);
        //     http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
        //     Http.send(updatedCoords);
        // }

        function updateCoords(newCoords){
            if (newCoords[0] > 9 || newCoords[1] > 9 || newCoords[0] < 0 || newCoords[1] < 0){
                return
            }
            currentCoords = newCoords
        }

        function moveShip(newCoords) {
            //updateServer(currentCoords)
            //Remove the visual ship
            $(document.getElementById("grid").rows[currentCoords[0]].cells[currentCoords[1]]).html("<p></p>");
            updateCoords(newCoords)
            //Redraw the ship
            $(document.getElementById("grid").rows[currentCoords[0]].cells[currentCoords[1]]).html("<img class='spaceship' src=/static/images/spaceship.png>");
        }
        placeShip()
    </script>
</body>
</html>